function RetrieveContact(n){var t=getXMLHttpRequest();t!=null?n[0]!=null&&(t.open("GET",Xrm.Page.context.prependOrgName("/XRMServices/2011/OrganizationData.svc/ContactSet?$filter=ContactId%20eq%20(guid'"+n[0].id+"')&$select=Address1_Line1,Address1_Line2,Address1_City,Telephone1,ac_stateprovinceid,ac_countryid,Address1_PostalCode"),!0),t.onreadystatechange=function(){DisplayAccountData(t)},t.send()):alert("not supported")}function getXMLHttpRequest(){if(window.XMLHttpRequest)return new window.XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(n){return null}}function DisplayAccountData(n){if(n.readyState==4&&n.status==200){xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async=!1,xmlDoc.loadXML(n.responseText);var i=xmlDoc.selectSingleNode("//d:Address1_Line1").text,r=xmlDoc.selectSingleNode("//d:Address1_Line2").text,u=xmlDoc.selectSingleNode("//d:Address1_City").text,f=xmlDoc.selectSingleNode("//d:ac_stateprovinceid/d:Id").text,e=xmlDoc.selectSingleNode("//d:ac_stateprovinceid/d:Name").text,o=xmlDoc.selectSingleNode("//d:ac_countryid/d:Id").text,s=xmlDoc.selectSingleNode("//d:ac_countryid/d:Name").text,h=xmlDoc.selectSingleNode("//d:Address1_PostalCode").text,c=xmlDoc.selectSingleNode("//d:Telephone1").text;Xrm.Page.getAttribute("ac_street1").setValue(i),Xrm.Page.getAttribute("ac_street2").setValue(r),Xrm.Page.getAttribute("ac_city").setValue(u),Xrm.Page.getAttribute("ac_postalcode").setValue(h),Xrm.Page.getAttribute("ac_telephone").setValue(c),t("ac_stateid",f,e,"ac_state"),t("ac_countryid",o,s,"ac_country");function t(n,t,i,r){var u=[];u[0]={},u[0].id=t,u[0].name=i,u[0].typename=r,Xrm.Page.getAttribute(n).setValue(u)}}}